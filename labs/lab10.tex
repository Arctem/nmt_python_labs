% LAB 10: Classes
% 
% CSE/IT 107: Introduction to Programming
% New Mexico Tech
% 
% Prepared by Russell White and Christopher Koch
% Spring 2015
\documentclass[11pt]{cselabheader}
\usepackage{caption}

%%%%%%%%%%%%%%%%%% SET TITLES %%%%%%%%%%%%%%%%%%%%%%%%%
\fancyhead[R]{Lab 10: Classes}
\title{Lab 10: Classes}

\begin{document}

\maketitle

\hrule
\begin{quotation}
``Holy shit, you geeks are badass.''
\end{quotation}
\begin{flushright}
  --- Pam (\emph{Archer})
\end{flushright}

\hrule

\pagebreak
\section{Introduction}


\pagebreak

\section{Classes and Objects}
\label{sec:classes}
In Python, classes are a way to group together functions and attributes
that are closely related to one another. A \lstinline{class} is defined
similarly to a function, though it uses the \lstinline{class} keyword rather
than \lstinline{def}.

\begin{pyconcode}
>>> class Test:
...     i = 5
...     def hi():
...         print('Hello world.')
... 
>>> Test.i
5
>>> Test.hi()
Hello world.
\end{pyconcode}

Once a class has been declared, an \emph{Object} or
\emph{Instance} of that class can be created. An object is an independent
copy of the class, with all of the same attributes and functions that were
declared with the class that the object was created from. This is the
primary use for classes, as it allows for you to easily create a group of
objects that store the same kind of data.

When doing this, it is important to declare a special function called
\lstinline{__init__} inside the class. This function is called when
creating the new class and can be used to initialize values for the
new object:

\begin{python3code}
class Test:
    def __init__(self):
        self.x = 10

    def set(self, x):
        self.x = x

a = Test()
b = Test()
print(a.x, b.x) #10 10
a.set(20)
print(a.x, b.x) #20 10
\end{python3code}

Note the use of the variable \lstinline{self} in the function declarations.
This variable should be first in any function declared that needs to be used on
a function level. This variable refers to the object that the function is
being called on. For example, in line 11, \lstinline{self} would refer to
\lstinline{a}. Note that \lstinline{a.set(20)} is equivalent to
\lstinline{Test.set(a, 20)}. The former is preferred because it is shorter and
more readable. Any variable referred to with \lstinline{self.variablename} will
stay with the object, while other variables will stay local to the function.

\lstinline{__init__} can be passed additional arguments in addition to
\lstinline{self} so that the new objects can be initialized differently.

The special function \lstinline{__str__(self)} can be defined to override
how the object is displayed when printed. By default, printing an object will
display something like this:

\begin{pyconcode}
>>> class Test:
...     pass
... 
>>> a = Test()
>>> print(a)
<__main__.Test object at 0x7f2b806cc9e8>
\end{pyconcode}

However, if we define the function, it will instead print whatever we want it
to. \lstinline{__str__} should always return a string.

\begin{python3code}
class Test:
    def __init__(self):
        self.x = 5

    def __str__(self):
        return 'x = {}'.format(self.x)

a = Test()
print(a)
\end{python3code}

Try running the above code. It should print out \lstinline{x = 5}. Overriding
\lstinline{__str__} makes our output code far simpler when printing objects.

\section{Inheritance}
\label{sec:inheritance}
A class can be built on another class. This is commonly done when multiple
classes should logically be different but share common functionality. A class
that inherits from another class is considered to be a subclass of its parent
class. The subclass gains all the functions and attributes of its parent class.

An example
might be that both Books and Articles could be considered Publications. Both
would have a title and an author, but only the book would have a chapter count.

\begin{python3code}
class Publication:
    def __init__(self, title, author):
        self.title = title
        self.author = author

    def __str__(self):
        return '{} by {}'.format(self.title, self.author)

class Book(Publication):
    def __init__(self, title, author, chapters):
        Publication.__init__(self, title, author)
        self.chapters = chapters

class Article(Publication):
    def __init__(self, title, author, magazine):
        Publication.__init__(self, title, author)
        self.magazine = magazine

    def __str__(self):
        return '{} by {}, published in {}'.format(self.title, self.author,
            self.magazine)

b = Book('Title', 'Author', 100)
a = Article('Other Title', 'Other Author', 'Some Magazine')

print(b) #Title by Author
print(a) #Other Title by Other Author, published in Some Magazine
\end{python3code}

Note that \lstinline{Article} creates its own version of the \lstinline{__str__}
function, while \lstinline{Book} does not. This means that \lstinline{Book}
simply uses the function that it inherits from \lstinline{Publication}.

Also note that each of the subclasses call the constructors of the parent class.
This is required to properly initialize the attributes of the object. Though it
is not strictly required, doing otherwise would require duplicating the
contents of the parent class's constructor in the subclass. A class can inherit
from multiple other classes. In that case, it would be expected to call the
constructors for both of its parent classes.

Sometimes you will want to check if an object belongs to a specific class. This
can be done with the \lstinline{isinstance} function. This function will return
\lstinline{True} if the given object is an instance of the given class or of a
subclass of that class.

\begin{python3code}
class A:
    pass
class B:
    pass
class C(A):
    pass
class D(C, B):
    pass

print(isinstance(A(), A)) #True
print(isinstance(B(), A)) #False
print(isinstance(C(), A)) #True
print(isinstance(D(), B)) #True
\end{python3code}


\clearpage
\section{Exercises}
\label{sec:ex}

\begin{ex}[library.py]
    Create a module called \lstinline{library}. This module should include two
    classes as well as methods for each. The provided file
    \lstinline{library_test.py} will use the contents of \lstinline{library.py}.
    Do not edit \lstinline{library_test.py} for your submission, though you are
    free to comment out lines using parts of \lstinline{library.py} that you
    have not implemented yet. The contents of \lstinline{library.py} should be
    as follows:

    \begin{description}
    \item[class Library] A \lstinline{Library} object stores multiple
        \lstinline{Book}
        objects and has methods to return statistics about those books. When
        printed, the object should list all of the books it contains in
        alphabetical order by author (as listed. You do not need to split into
        first and last names).
        \begin{description}
        \item[def add\_book(self, book)] This method takes in either a line of
            text or a book object. If the input is a line of text, then it
            creates a new \lstinline{Book} object out of it. The object
            (whether given or created) is then stored inside the library.
        \item[def get\_authors(self)] This method returns a list of all the
            authors who have works contained in the library. No author should
            appear more than once.
        \item[def get\_books\_per\_author(self)] This method returns a
            dictionary.
            Each author should be a key in the dictionary. The value for each
            author should be the number of books by that author in the library.
        \end{description}
    \item[class Book] A \lstinline{Book} object stores the author and title of
        a book. When printed, the object should display both the title and
        author of the book. The constructor should take in two arguments:
        the title of the book and the author of the book.
    \end{description}
\end{ex}

\pagebreak
\section{Submitting}
You should submit your code as a tarball. It should contain all files
used in the exercises for this lab. The submitted file should be named
\begin{center}
  \texttt{cse107\_firstname\_lastname\_lab10.tar.gz}
\end{center}

\begin{center}
  \textbf{Upload your tarball to Canvas.}
\end{center}

\listoftheorems


\end{document}
